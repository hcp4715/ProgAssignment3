a <- DT[, .SD[,paste(x,v, sep="", collapse="_")], by=y]
bestHP <- df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
bestHP <- df[,.SD[,which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
bestHP <- valide_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
View(valide_df)
data <- structure(list(State = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L,
2L), .Label = c("AK", "RI"), class = "factor"), Company = structure(1:8, .Label = c("A",
"B", "C", "D", "E", "F", "G", "H"), class = "factor"), Employees = c(82L,
104L, 37L, 24L, 19L, 118L, 88L, 42L)), .Names = c("State", "Company",
"Employees"), class = "data.frame", row.names = c(NA, -8L))
data
DT <- data.table(data)
View(DT)
View(data)
DT[,.SD[which.min(Employees)],by=State]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
View(bestHP)
valid
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack`)],by=State]
View(bestHP)
min(valid_df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
sum(is.na(valid_df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
min(valid_df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)
tapply(valid_df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,valid_df$State,min)
View(bestHP)
best <- function(state,outcome){
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
## for heart attack
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
best <- bestHP$`Hospital.Name`[bestHP$State == state]
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack`)],by=State]
best <- bestHP$`Hospital.Name`[bestHP$State == state]
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia`)],by=State]
best <- bestHP$`Hospital.Name`[bestHP$State == state]
}
## Return hospital name in that state with lowest 30-day death
## rate
return best
}
results <- na
results <- c()
best <- function(state,outcome){
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## for heart attack
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
results <- bestHP$`Hospital.Name`[bestHP$State == state]
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack`)],by=State]
results <- bestHP$`Hospital.Name`[bestHP$State == state]
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia`)],by=State]
results <- bestHP$`Hospital.Name`[bestHP$State == state]
}
## Return hospital name in that state with lowest 30-day death
## rate
return results
}
best <- function(state,outcome){
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## for heart attack
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure`)],by=State]
results <- bestHP$`Hospital.Name`[bestHP$State == state]
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack`)],by=State]
results <- bestHP$`Hospital.Name`[bestHP$State == state]
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
valid_df <- data.table(valide_df)
bestHP <- valid_df[,.SD[which.min(`Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia`)],by=State]
results <- bestHP$`Hospital.Name`[bestHP$State == state]
}
## Return hospital name in that state with lowest 30-day death
## rate
results
}
best("TX","heart failure")
best("TX","heart attack")
best("MD", "heart attack")
best("MD", "pneumonia")
best("BB", "heart attack")
aggregate(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack ~ State, valid_df, function(x) min(x))
DT <-data.table(valid_df)
DT[,list(rate = min(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)),by=State]
DT[DT[, .I[which.min(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)], by=State]$V1]
teste <- DT[DT[, .I[which.min(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)], by=State]$V1]
View(teste)
?message
?stop
rm(list=ls())
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == "TX",]
ranking <- order(state_df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure)
state_df$Rank <- ranking
View(state_df)
temp <- state_df[,c(2,17,47)]
head(temp)
state_rank <- temp[order(Rank,Hospital.Name),]
View(temp)
state_rank <- temp[order(temp$Rank,Hospital.Name),]
state_rank <- temp[order(temp$Rank,temp$Hospital.Name),]
View(state_rank)
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
View(state_rank)
View(state_df)
rm(list=ls())
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == "TX",]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
View(state_rank)
ranking <- c(1:length(state_rank))
ranking <- seq(1:length(state_rank))
1:10
ranking <- 1:length(state_rank)
ranking
ranking <- 1:length(state_rank)
length(state_rank)
ranking <- 1:nrow(state_rank)
state_rank$Rank <- 1:nrow(state_rank)
View(state_rank)
head(state_rank)
head(state_rank$Hospital.Name)
head(state_rank$Hospital.Name)[1]
tail(state_rank$Hospital.Name)
tail(state_rank$Hospital.Name)[1]
tail(state_rank$Hospital.Name,1)
head(state_rank$Hospital.Name,1)
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == "TX",]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
state_df <- valid_df[valid_df$State == "TX",]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
state_df <- valid_df[valid_df$State == "TX",]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
}
## Return hospital name in that state with the given rank
## 30-day death rate
results
}
rankhospital("TX","heart failure",4)
rankhospital("MD", "heart attack", "worst")
## This script is to rank the hospitals based on the mortality data for every state
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
}
## Return hospital name in that state with the given rank
## 30-day death rate
results
}
rankhospital("MD", "heart attack", "worst")
## This script is to rank the hospitals based on the mortality data for every state
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,11)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,23)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
}
## Return hospital name in that state with the given rank
## 30-day death rate
results
}
rankhospital("MD", "heart attack", "worst")
## This script is to rank the hospitals based on the mortality data for every state
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else if (num > nrow(state_rank){
results <- NA
} else {
results <- state_rank$Hospital.Name[num]
}
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,11)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,23)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
}
## Return hospital name in that state with the given rank
## 30-day death rate
results
}
## This script is to rank the hospitals based on the mortality data for every state
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else if(num > nrow(state_rank)){
results <- NA
} else {
results <- state_rank$Hospital.Name[num]
}
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,11)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,23)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else {
results <- state_rank$Hospital.Name[num]
}
}
## Return hospital name in that state with the given rank
## 30-day death rate
results
}
## This script is to rank the hospitals based on the mortality data for every state
rankhospital <- function(state, outcome, num = "best") {
## Read outcome data
df <- read.csv("outcome-of-care-measures.csv",colClasses = "character")
df[,11] <- as.numeric(df[,11])
df[,17] <- as.numeric(df[,17])
df[,23] <- as.numeric(df[,23])
results <- c()
## Check that state and outcome are valid
if (outcome == "heart failure"){
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,17)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else if(num > nrow(state_rank)){
results <- NA
} else {
results <- state_rank$Hospital.Name[num]
}
} else if (outcome == "heart attack") {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,11)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else if(num > nrow(state_rank)){
results <- NA
} else {
results <- state_rank$Hospital.Name[num]
}
} else {
valid_df <- df[complete.cases(df$State) & complete.cases(df$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia),]
state_df <- valid_df[valid_df$State == state,]
temp <- state_df[,c(2,23)]
state_rank <- temp[order(temp$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia,temp$Hospital.Name),]
state_rank$Rank <- 1:nrow(state_rank)
if (num == "best"){
results <- head(state_rank$Hospital.Name)[1]
} else if (num == "worst"){
results <- tail(state_rank$Hospital.Name,1)
} else if(num > nrow(state_rank)){
results <- NA
} else {
results <- state_rank$Hospital.Name[num]
}
}
## Return hospital name in that state with the given rank
## 30-day death rate
results
}
rankhospital("MN", "heart attack", 5000)
q()
